---
title:CAE指南
description: '上下文感知編碼 (CAE) 分析每個源視頻，並為每個內容智能地構建自定義比特率階梯（一組再現）。此外，「內容感知編碼」會考慮與用來檢視內容的傳遞網路和裝置相關的限制。它決定了需要多少轉譯，以及每個節目使用哪些解析度和位元率，同時在所有標題中仍保持一致的品質水平。這樣可大幅節省儲存空間和頻寬成本，同時改善使用者的播放體驗。如需其他資訊，請參閱內容感知編碼<a href="/general-information/overview-context-aware-encoding.html">概觀</a>。'
parent: Encoding Guides
---
 <h1>{{ page.title }}</h1>     
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Overview">概述</h2>

    <aside class="bcls-aside bcls-aside--information">筆記：
      <ul>
        <li>並非所有Zencoder客戶都可以使用上下文感知編碼。如果您對是否可以使用上下文感知編碼有疑問，請聯繫您的客戶經理。</li>
        <li>這<a href="/encoding-guides/av1-guide.html">AV1視頻編解碼器</a>當前不支持CAE作業。</li>
      </ul>
      </aside>
  </section>
  <section class="bcls-section">
    <h2 id="process">程序</h2>

    <p>通過設置在Zencoder作業上啟用CAE <code translate="No"><a href="/encoding-settings/general/encoding-settings-job.html#generate_dynamic_profile"><code translate="No">generate_dynamic_profile</code></a></code>真實並添加<a href="/encoding-settings/general/encoding-settings-general-output-settings.html#dynamic_profile_rendition"><code translate="No">dynamic_profile_rendition</code></a>值到作業的輸出。另外，您可以添加<a href="/encoding-settings/general/cae-settings.html"><code translate="No">dynamic_profile_options</code></a>，但這不是必需的。下載並檢查作業的輸入源文件後，Zencoder在源文件上運行CAE動態配置文件生成器。生成的動態輪廓梯形圖設置在編碼之前已添加到每個相應的輸出。將為dynamic_profile_rendition值的輸出自動設置以下設置：</p>

    <ul>
      <li><code translate="No">width</code></li>
      <li><code translate="No">height</code></li>
      <li><code translate="No">frame_rate</code></li>
      <li><code translate="No">video_codec</code></li>
      <li><code translate="No">video_codec_profile</code></li>
      <li><code translate="No">video_codec_tier</code></li>
      <li><code translate="No">video_codec_level</code></li>
      <li><code translate="No">video_reference_frames</code></li>
      <li><code translate="No">video_bframes</code></li>
      <li><code translate="No">video_bitrate</code></li>
      <li><code translate="No">decoder_bitrate_cap</code></li>
      <li><code translate="No">decoder_buffer_size</code></li>
      <li><code translate="No">keyframe_rate</code></li>
      <li><code translate="No">fixed_keyframe_interval</code></li>
    </ul>
    <p><strong>混合編解碼器輸出：</strong>您可以輸出混合的HEVC / H.264再現。看<a href="/encoding-settings/general/cae-settings.html">CAE設置</a>有關詳細信息。</p>
    <p>其他沒有輸出的輸出<a href="/encoding-settings/general/encoding-settings-general-output-settings.html#dynamic_profile_rendition"><code translate="No">dynamic_profile_rendition</code></a>將在動態配置文件生成器運行時同時檢查輸入源後立即開始編碼。</p>
  </section>
  <section class="bcls-section">
    <h2 id="guidelines_for_configuring_dynamic_profile_options">配置準則<a href="/encoding-settings/general/encoding-settings-general-output-settings.html#dynamic_profile_rendition"><code translate="No">dynamic_profile_options</code></a></h2>

    <h3>演繹次數</h3>

    <p>創建的最小和最大演繹次數由<a href="/encoding-settings/general/cae-settings.html#min_renditions">min_renditions</a>和<a href="/encoding-settings/general/cae-settings.html#max_renditions">max_renditions</a>設置。為了獲得最佳性能，建議在這些限制之間留出一定的差距（例如，設置<code translate="No">min_renditions</code>到2和<code translate="No">max_renditions</code>到10），允許CAE配置文件生成器選擇最適合每個內容的編號。為了易於編碼內容，它可以產生更少的演繹，而對於更複雜的內容，它可以產生更多。還建議將min_renditions設置得盡可能小，以在不需要更多再現時節省帶寬。</p>

    <h3>決議案</h3>

    <p>默認情況下，CAE使用大約30種標準分辨率的階梯，範圍從<code translate="No">192x108</code>至<code translate="No">7680x4320</code>。可以通過使用<a href="/encoding-settings/general/cae-settings.html#min_resolution">最小分辨率</a>和<a href="/encoding-settings/general/cae-settings.html#max_resolution">max_resolution</a>設置。或者，可以在<a href="/encoding-settings/general/cae-settings.html#video_configurations"><code translate="No">video_configurations</code></a>環境。</p>

    <h3>GOP長度</h3>

    <p>這<a href="/encoding-settings/general/cae-settings.html#keyframe_rate"><code translate="No">keyframe_rate</code></a>設置控制最大值<code translate="No">GOP</code>編碼內容的長度。將此設置為與<a href="/encoding-settings/general-audio-video/encoding-settings-segmented-streaming.html#segment_seconds"><code translate="No">segment_seconds</code></a>用於HLS / DASH編碼。否則，建議使用0.5的值，相當於2秒<code translate="No">GOP</code>長度。</p>

    <h3>比特率覆蓋</h3>

    <p>可以使用的比特率限制可以通過<a href="/encoding-settings/general/cae-settings.html#min_bitrate"><code translate="No">min_bitrate</code></a>和<a href="/encoding-settings/general/cae-settings.html#max_bitrate"><code translate="No">max_bitrate</code></a>設置。這將指示CAE至少分配<a href="/encoding-settings/general/cae-settings.html#min_bitrate"><code translate="No">min_bitrate</code></a>第一次重演的Kbps，並將最後一次重演限制為最大<a href="/encoding-settings/general/cae-settings.html#max_bitrate"><code translate="No">max_bitrate</code></a> Kbps。</p>

    <p>為確保演繹比特率間隔適當，請使用<a href="/encoding-settings/general/cae-settings.html#min_granularity"><code translate="No">min_granularity</code></a>和<a href="/encoding-settings/general/cae-settings.html#max_granularity"><code translate="No">max_granularity</code></a>設置。例如，這些可用於確保從一個比特率到下一個比特率的步幅不小於50％的比特率增加或大於100％的比特率增加。請注意，大多數流創作指南均建議粒度不超過100％。</p>

    <h3>啟動延遲，惡劣網絡條件下的可靠性</h3>

    <p>為確保比特率階梯始終以足夠低的比特率開始，請使用<a href="/encoding-settings/general/cae-settings.html#max_first_rendition_bitrate"><code translate="No">max_first_rendition_bitrate</code></a>環境。設置的第一再現比特率越低，由於連接速度低，視頻播放器需要緩衝的可能性就越小。此外，如果流式清單表明首先加載最低比特率，則這也將直接影響啟動延遲。</p>

    <h3>支持舊設備</h3>

    <p>支持僅能使用的舊設備<code translate="No"><code translate="No">Baseline</code></code>配置文件H.264播放，請使用<a href="/encoding-settings/general/cae-settings.html#select_baseline_profile_configuration"><code translate="No">select_baseline_profile_configuration</code></a>環境。設置此項後，至少有一個演繹將被編碼為<code translate="No">Baseline</code>輪廓。附加約束（編解碼器配置文件，級別，參考幀數，b幀等）可以通過自定義進行控制<a href="/encoding-settings/general/cae-settings.html#video_configurations"><code translate="No">video_configurations</code></a>環境。</p>
    <p>注意<code translate="No">select_baseline_profile_configuration</code>是<code translate="No">true</code>默認情況下，它需要 <em>至少一個演繹</em> 具有等於或低於 512x288 的分辨率。</p>

    <h3>VBR可變性控制</h3>

    <p>最大峰值比特率可以通過<a href="/encoding-settings/general/cae-settings.html#bitrate_cap_to_bitrate_ratio"><code translate="No">bitrate_cap_to_bitrate_ratio</code></a>和<a href="/encoding-settings/general/cae-settings.html#bitrate_cap_offset">bitrate_cap_offset</a>設置。如果是比特率“<code translate="No">R</code>選擇“"進行演繹，然後<a href="/encoding-settings/general-audio-video/encoding-settings-rate-control.html#decoder_bitrate_cap">coder_bitrate_cap</a>計算公式為：</p>

    <pre class="line-numbers">
  <code class="language-javascript" translate="No">decoder_bitrate_cap = R * bitrate_cap_to_bitrate_ratio + bitrate_cap_offset</code></code></pre>

    <p>同樣，解碼器緩衝區限制可以通過<a href="/encoding-settings/general/cae-settings.html#buffer_size_to_bitrate_ratio"><code translate="No">buffer_size_to_bitrate_ratio</code></a>和<a href="/encoding-settings/general/cae-settings.html#buffer_size_offset"><code translate="No">buffer_size_offset</code></a>設置。這<a href="/encoding-settings/general-audio-video/encoding-settings-rate-control.html#decoder_buffer_size"><code translate="No">decoder_buffer_size</code></a>計算公式為：</p>

    <pre class="line-numbers">
  <code class="language-javascript" translate="No">decoder_buffer_size = R * buffer_size_to_bitrate_ratio + buffer_size_offset</code></pre>

    <p>請注意，峰值比特率和緩衝區限制也可能受編解碼器配置文件和/或級別設置的約束。通過限制可以避免一些一般的設備兼容性問題<a href="/encoding-settings/general/cae-settings.html#bitrate_cap_to_bitrate_ratio"><code translate="No">bitrate_cap_to_bitrate_ratio</code></a>到2.0或更低，以及<a href="/encoding-settings/general/cae-settings.html#buffer_size_to_bitrate_ratio"><code translate="No">buffer_size_to_bitrate_ratio</code></a>至<code translate="No">2.0 * GOP length</code>（馬上）。</p>
  </section>
  <section class="bcls-section">
    <h2 id="CAE_and_Segmented_outputs">CAE和分段輸出</h2>

    <p>CAE與Zencoder中的分段輸出兼容。在<code translate="No">Output</code>演繹設置，設置<a href="/encoding-settings/general/encoding-settings-general-output-settings.html#type"><code translate="No">type</code></a>作為<code translate="No">segmented</code>和適當的<a href="/encoding-settings/general-audio-video/encoding-settings-segmented-streaming.html#segment_seconds"><code translate="No">segment_seconds</code></a>價值。還，<a href="/encoding-settings/general/cae-settings.html#keyframe_rate"><code translate="No">keyframe_rate</code></a>和<a href="/encoding-settings/general-audio-video/encoding-settings-frame-rate.html#fixed_keyframe_interval"><code translate="No">fixed_keyframe_interval</code></a>設置必須在<code translate="No">dynamic_profile_options</code>。</p>

    <h3>CAE-HLS示例</h3>

    <pre class="line-numbers">
  <code class="language-json" translate="No">{
    "input": "s3://test_bucket/test_media.mp4",
    "generate_dynamic_profile": true,
    "dynamic_profile_options": {
      "max_renditions": 6,
      "min_renditions": 2,
      "select_baseline_profile_configuration": true,
      "keyframe_rate": "0.5",
      "fixed_keyframe_interval": "true"
    },
    "outputs": [
      {
        "label": "CAE1",
        "dynamic_profile_rendition": 1,
        "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE1",
        "filename": "CAE1.m3u8",
        "type": "segmented",
        "segment_seconds": 2,
        "byte_range_segmenting": true,
        "generate_keyframe_manifest": "true",
        "hls_protocol_version": 7,
        "skip_audio": true
      },
      {
        "label": "CAE2",
        "dynamic_profile_rendition": 2,
        "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE2",
        "filename": "CAE2.m3u8",
        "type": "segmented",
        "segment_seconds": 2,
        "byte_range_segmenting": true,
        "generate_keyframe_manifest": "true",
        "hls_protocol_version": 7,
        "skip_audio": true
      },
      {
        "label": "CAE3",
        "dynamic_profile_rendition": 3,
        "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE3",
        "filename": "CAE3.m3u8",
        "type": "segmented",
        "segment_seconds": 2,
        "byte_range_segmenting": true,
        "generate_keyframe_manifest": "true",
        "hls_protocol_version": 7,
        "skip_audio": true
      },
      {
        "label": "CAE4",
        "dynamic_profile_rendition": 4,
        "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE4",
        "filename": "CAE4.m3u8",
        "type": "segmented",
        "segment_seconds": 2,
        "byte_range_segmenting": true,
        "generate_keyframe_manifest": "true",
        "hls_protocol_version": 7,
        "skip_audio": true
      },
      {
        "label": "CAE5",
        "dynamic_profile_rendition": 5,
        "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE5",
        "filename": "CAE5.m3u8",
          "type": "segmented",
          "segment_seconds": 2,
          "byte_range_segmenting": true,
          "generate_keyframe_manifest": "true",
          "hls_protocol_version": 7,
          "skip_audio": true
        },
        {
          "label": "CAE6",
          "dynamic_profile_rendition": 6,
          "base_url": "s3://test_bucket/outputs/HLS_CAE/CAE6",
          "filename": "CAE6.m3u8",
          "type": "segmented",
          "segment_seconds": 2,
          "byte_range_segmenting": true,
          "generate_keyframe_manifest": "true",
          "hls_protocol_version": 7,
          "skip_audio": true
        }
        {
          "label": "Audio",
          "audio_bitrate": "128",
          "type": "segmented",
          "segment_seconds": 2,
          "byte_range_segmenting": true,
          "skip_video": true,
          "base_url": "s3://test_bucket/outputs/HLS_CAE/Audio/128k/",
          "filename": "audio_128k.ac3"
        },
        {
          "base_url": "s3://test_bucket/outputs/HLS_CAE/",
          "filename": "master_playlist.m3u8",
          "hls_protocol_version": 7,
          "type": "playlist",
          "allow_skipped_sources": true,
          "alternate_audio": {
            "128k_audio": {
              "path": "Audio/128k/audio_128k.m3u8",
              "language": "en",
              "source": "Audio"
            }
          }
          ],
          "streams": [
            {
              "path": "CAE1/CAE1.m3u8",
              "source": "CAE1",
              "audio": "128k_audio"
            },
            {
              "path": "CAE2/CAE2.m3u8",
              "source": "CAE2",
              "audio": "128k_audio"
            },
            {
              "path": "CAE3/CAE3.m3u8",
              "source": "CAE3",
              "audio": "128k_audio"
            },
            {
              "path": "CAE4/CAE4.m3u8",
              "source": "CAE4",
              "audio": "128k_audio"
            },
            {
              "path": "CAE5/CAE5.m3u8",
              "source": "CAE5",
              "audio": "128k_audio"
            },
            {
              "path": "CAE6/CAE6.m3u8",
              "source": "CAE6",
              "audio": "128k_audio"
            }
          ]
        }
      ]
    }</code></pre>

    <h3>CAE-DASH示例</h3>

    <pre class="line-numbers">
  <code class="language-json" translate="No">
  {
    "input": "s3://test_bucket/test.mov",
    "generate_dynamic_profile": true,
    "dynamic_profile_options": {
      "max_renditions": 6,
      "min_renditions": 2,
      "select_baseline_profile_configuration": true,
      "keyframe_rate": "0.5",
      "fixed_keyframe_interval": "true"
    },
    "outputs": [
      {
        "label": "CAE1",
        "dynamic_profile_rendition": 1,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE1",
        "filename": "CAE1.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "CAE2",
        "dynamic_profile_rendition": 2,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE2",
        "filename": "CAE2.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "CAE3",
        "dynamic_profile_rendition": 3,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE3",
        "filename": "CAE3.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "CAE4",
        "dynamic_profile_rendition": 4,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE4",
        "filename": "CAE4.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "CAE5",
        "dynamic_profile_rendition": 5,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE5",
        "filename": "CAE5.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "CAE6",
        "dynamic_profile_rendition": 6,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/CAE6",
        "filename": "CAE6.mpd",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_audio": true,
        "public": true
      },
      {
        "label": "Audio",
        "audio_bitrate": "128",
        "type": "segmented",
        "segment_seconds": 10,
        "streaming_delivery_format": "dash",
        "skip_video": true,
        "base_url": "s3://test_bucket/outputs/DASH_CAE/Audio/128k/",
        "filename": "audio_128k.mpd",
        "public": true
      },
      {
        "base_url": "s3://test_bucket/outputs/DASH_CAE/",
        "filename": "master_playlist.mpd",
        "streaming_delivery_format": "dash",
        "type": "playlist",
        "allow_skipped_sources": true,
        "public": true,
        "streams": [
          {
            "path": "CAE1/CAE1.mpd",
            "source": "CAE1"
          },
          {
            "path": "CAE2/CAE2.mpd",
            "source": "CAE2"
          },
          {
            "path": "CAE3/CAE3.mpd",
            "source": "CAE3"
          },
          {
            "path": "CAE4/CAE4.mpd",
            "source": "CAE4"
          },
          {
            "path": "CAE5/CAE5.mpd",
            "source": "CAE5"
          },
          {
            "path": "CAE6/CAE6.mpd",
            "source": "CAE6"
          },
          {
            "path": "Audio/128k/audio_128k.mpd",
            "source": "Audio"
          }
        ]
      }
    ]
   }
  </code></pre>
  </section>
</article>