---
title:將Zencoder與S3描述一起使用：Zencoder可以從您的Amazon S3存儲桶上傳和下載文件。要讓 Zencoder 下載文件，它們需要可供所有人訪問，或者需要將存儲桶策略添加到您的存儲桶以授予 Zencoder 訪問權限，或者您必須將憑據保存到您的帳戶以訪問存儲桶。
parent: General Information
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

	<section class="bcls-section">
		<h2 id="Introduction">簡介</h2>
		<p>Zencoder可以從您的Amazon S3存儲桶上傳和下載文件。為了使Zencoder下載文件，每個人都需要訪問它們，或者需要將存儲桶策略添加到您的存儲桶中以授予Zencoder訪問權限，或者您必須將憑據保存到帳戶中才能訪問存儲桶。</p>
		<aside class="bcls-aside bcls-aside--information">請注意，Zencoder 僅支持 Amazon AWS S3 存儲桶。<strong>來自非亞馬遜供應商的 S3 兼容存儲桶是 <em>不</em> 支持的。</strong></aside>
	</section>

  <section class="bcls-section">
    <h2 id="Use_credentials">使用憑證</h2>

    <p>你可以保存<a href="/encoding-settings/general/encoding-settings-general-output-settings.html#credentials">證書</a>到您的帳戶，這將使我們能夠使用您的帳戶上傳文件而不是我們的文件。這意味著您的帳戶是文件的所有者，並擁有文件的全部權利和特權。您可以將憑據設置為所有上載和下載的默認憑據，或在每個請求中引用它們，但是請記住，如果將它們設置為S3的默認憑據，則它們將用於所有S3上載和下載。通常這不是問題，但是如果以後您想上傳到第三方的存儲桶，則可能會引起問題。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Use_a_bucket_policy">使用存儲桶策略</h2>

    <p>另一種選擇是使用存儲桶策略，該策略可讓您設置存儲桶中所有文件的權限。要開始使用，請訪問<a href="http://aws.amazon.com/console/">AWS控制台</a>。在屏幕左側選擇您的存儲桶，然後單擊“屬性"。在最後一行上，單擊“添加存儲桶策略"。我們將在下面將“存儲桶策略"放在一起，然後將其複製到“存儲桶策略"文本框中。</p>

    <p>我們建議的存儲桶策略：</p>

    <pre class="line-numbers">
 <code class="language-json" translate="No">{
"Version": "2012-10-17",
"Id": "ZencoderBucketPolicy",
"Statement": [
  {
      "Sid": "Stmt1295042087538",
      "Effect": "Allow",
      "Principal": {
          "AWS": "arn:aws:iam::395540211253:root"
      },
      "Action": [
      "s3:GetObjectAcl",
      "s3:GetObject",
      "s3:PutObjectAcl",
      "s3:PutObject",
      "s3:ListMultipartUploadParts"
      ],
      "Resource": "arn:aws:s3:::MY-BUCKET/*"
  },
  {
      "Sid": "Stmt1295042087538",
      "Effect": "Allow",
      "Principal": {
          "AWS": "arn:aws:iam::395540211253:root"
      },
      "Action": [
      "s3:ListBucketMultipartUploads",
      "s3:GetBucketLocation"
      ],
      "Resource": "arn:aws:s3:::MY-BUCKET"
  }
]
}</code></pre>
    <aside class="bcls-aside bcls-aside--warning">請注意，即使您使用此策略，如果存儲桶設置為阻止公共 ACL，上傳也會失敗：
      <figure class="bcls-figure"><img class="bcls-image" alt="S3 ACL Permissions" src="/assets/images/general-information/acl-policy.png" />
        <figcaption class="bcls-caption--image">S3 ACL權限</figcaption>
      </figure>
    </aside>
    <p>只有<strong>您將必須進行的一項更改</strong>準備好執行此存儲桶策略之前。</p>

    <ol>
      <li>用您的存儲桶名稱替換MY-BUCKET。將/ *保留在該行的末尾，因為這會將策略應用於存儲桶中的每個文件。</li>
      <li>（可選）用您要允許的操作替換Action數組。Zencoder可能需要採取的有效措施是：
        <h4>對象權限-上面示例中的第一個操作數組</h4>

        <ul>
          <li><code translate="No">s3:PutObject</code> -允許Zencoder將文件上傳到存儲桶</li>
          <li><code translate="No">s3:GetObject</code> -允許Zencoder從存儲桶下載文件</li>
          <li><code translate="No">s3:GetObjectAcl</code> -允許Zencoder獲得文件的ACL權限</li>
          <li><code translate="No">s3:PutObjectAcl</code> -允許Zencoder為文件上的其他用戶設置ACL權限</li>
          <li><code translate="No">s3:ListMultipartUploadParts</code> -允許Zencoder列出多部分文件的哪些部分已上傳到存儲桶</li>
        </ul>
        <h4>值區權限-上例中的第二個動作數組</h4>

        <ul>
          <li><code translate="No">s3:GetBucketLocation</code> -允許Zencoder獲取存儲桶的位置（美國，歐盟，亞洲等）</li>
          <li><code translate="No">s3:ListBucketMultipartUploads</code> -允許Zencoder查看存儲桶中當前正在執行的任何分段上傳
            <p><code translate="No">ex:</code>如果您希望Zencoder能夠下載和上傳文件，請用以下命令替換第一個Action數組：</p>

            <pre class="line-numbers">
<code class="language-json" translate="No">["s3:PutObject", "s3:GetObject"]</code></pre>
          </li>
        </ul>
      </li>
    </ol>
    <p>請注意，該策略中有兩個語句。第一部分影響存儲桶中的鍵，而第二部分影響存儲桶本身。</p>

    <p>該策略的其餘部分可以單獨使用，並且可以正常運行。亞馬遜的文檔包含有關以下內容的更多信息：<a href="http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?UsingBucketPolicies.html">桶策略的要素。</a></p>

    <p>Zencoder還可以在我們為您創建的視頻和縮略圖上設置ACL權限。這記錄在我們的<a href="/encoding-settings/sources-destinations/encoding-settings-s3-settings.html">S3 API文檔</a>。</p>

    <p><strong>筆記：</strong>使用存儲桶策略時，應始終使用s3：// BUCKET / KEY格式的URL，以便Zencoder可以確保將其標識為S3 URL並適當地簽署請求。</p>

    <p>如果您想建立自己的Bucket Policy，可以使用<a href="http://awspolicygen.s3.amazonaws.com/policygen.html">亞馬遜的政策生成器</a>。使用 <em>arn:aws:iam::395540211253:root</em> 作為 AWS 委託人以允許 Zencoder 訪問。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Specific_files">具體文件</h2>

    <h3>我可以只授予特定文件的權限嗎？</h3>

    <p>絕對可以。雖然“存儲桶策略"方法通常更容易，更快捷，但並不是每個人都適用。如果是這樣，您可以為我們的Amazon AWS帳戶授予權限，<code translate="No">aws@zencoder.com</code>。</p>

    <p>如果您需要使用我們的規範ID，則可以使用<code translate="No">6c8583d84664a381db0c6af0e79b285ede571885fbe768e7ea50e5d3760597dd</code>。</p>
  </section>
  <section class="bcls-section">
    <h2>疑難排解</h2>

    <h3 id="Troubleshooting">我的權限仍被拒絕！</h3>

    <p>如果訪問被拒絕或找不到文件，則S3響應“訪問被拒絕"。如果您認為自己已正確設置了S3憑據或存儲桶策略，但仍收到“訪問被拒絕"錯誤，請仔細檢查您提交的URL。如果輸入看起來像<code translate="No">"s3://my-bucket/this+file+is+great.mp4"</code>，您真正想要的是一個很好的機會<code translate="No">"s3://my-bucket/this file is great.mp4"</code></p>

    <h3>使用歐盟法蘭克福地區時出現錯誤！</h3>

    <p>為了將EU Frankfurt地區與Zencoder一起使用，必須生成包含地區名稱的S3 URL。為此，只需創建這樣的URL <code translate="No">"s3+eu-central-1://my-bucket/file.mp4"</code>。</p>
  </section>
</article>